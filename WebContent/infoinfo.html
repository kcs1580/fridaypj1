<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">

<!-- Font Awesome CSS -->
<link href="fonts/font-awesome/css/font-awesome.css" rel="stylesheet">

<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">

<link rel="stylesheet" href="css/style.css">

<style type="text/css">
.info-container {
	height:600px;
}

section {
	background: #FFFFFF;
}

.item {
	
	padding: 15px;
}

.item img {
	width: auto;
	height: auto;
	max-height: 250px;
	max-width: 250px;
	border: medium;
}

.item div {
	height: 400px;
	background: white;
}

.form-qty {
	height: 50px;
}

#infobt {
	margin: 20px 20px;
	height: 100px;
}

div.changsu {
	height: 50px;
}
</style>

<title>SSAFY</title>
</head>
<body>
	<header> </header>
	<nav class="navbar navbar-inverse"
		style="padding-right: 40px; padding-left: 40px;">
		<div class="alert alert-success" role="alert" style="display: none;">ssafy님, 환영합니다!</div>
		<div class="alert alert-danger" role="alert" style="display: none;">아이디 또는 패스워드가 틀렸습니다!</div>
		<ul class="nav navbar-nav navbar-right">
			<li>
				<a class="btn btn-sm" href="info.html">
					<span class="glyphicon glyphicon-user" aria-hidden="true"></span>
					<span>&nbsp;UserInfo</span>
				</a>
			</li>
			<li>
				<a class="btn btn-sm" href="index.html">
					<span class="glyphicon glyphicon-user" aria-hidden="true"></span>
					<span>&nbsp;Logout</span>
				</a>
			</li>
		</ul>
	</nav>

	<nav class="navbar navbar-default"
		style="background-color: #FFFFFF; border: 0;">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed"
					data-toggle="collapse" data-target="#bs-example-navbar-collapse-1"
					aria-expanded="false">
					<span class="sr-only">Toggle navigation</span> <span
						class="icon-bar"></span> <span class="icon-bar"></span> <span
						class="icon-bar"></span>
				</button>
			</div>

			<div class="collapse navbar-collapse"
				id="bs-example-navbar-collapse-1">
				<span class="nav navbar-nav navbar-left"><a href="_index.html"><img
						src="img/header-logo.jpg"></a></span>
				<ul class="nav navbar-nav navbar-center">
					<li><a href="#">공지 사항 <span class="sr-only">(current)</span></a></li>
					<li><a href="item.html">상품 정보</a></li>
					<li><a href="#">베스트 섭취 정보</a></li>
				</ul>
				<form class="navbar-form navbar-right">
					<div class="form-group">
						<input type="text" class="form-control" placeholder="Search">
					</div>
					<button type="submit" class="btn btn-default">
						<span class="glyphicon glyphicon-search"></span>
					</button>
				</form>
			</div>
		</div>
	</nav>

	<ol class="breadcrumb">
		<li><a href="_index.html"><span class="glyphicon glyphicon-home"></span>&nbsp;<span>
					Home</span></a></li>
		<li><a href="item.html">상품 정보</a></li>
		<li class="active"><a href="#">제품 상세 정보</a></li>
	</ol>

	<!-- main-container start -->
	<!-- ================ -->
	<div class="main-container">
		<div class="container">
			<div class="row justify-content-center">
				<div class="col-auto">
					<h1 align="center">제품 정보</h1>
					<h2 align="center">
						<span class="glyphicon glyphicon-ok-circle" aria-hidden="true"></span>
					</h2>




					<!-- main start -->
					<!-- ================ -->
					<section class="info-container">

						<div class="item">
							<div id="imagee" class="col-xs-3">
								

							</div>


							<div class="col-xs-9">

								<table class="table">

									<tr height="10pxx">
										<th>제품명</th>
										<td id="nameinfo"></td>
									</tr>
									<tr height="10px">
										<th>제조사</th>
										<td id="proinfo"></td>
									</tr>
									<tr height="100px">
										<th>원재료</th>
										<td id="inginfo"></td>
									</tr>
									<tr height="10px">
										<th>알레르기 성분</th>
										<td id="allinfo"></td>
									</tr>
								</table>
								<div class="changsu">
									<form class="form-qty">
										<div class="changsu">
											<label for="sel1">Quantity</label> <select
												class="form-control" id="sel1">
												<option>1</option>
												<option>2</option>
												<option>3</option>
												<option>4</option>
												<option>5</option>
												<option>6</option>
												<option>7</option>
												<option>8</option>
												<option>9</option>

											</select>
										</div>
									</form>
									<div id="infobt">
										<button type="submit" class="btn btn-primary">
											<span class="glyphicon glyphicon-user" aria-hidden="true"></span>추가
										</button>
										<button type="submit" class="btn btn-primary">
											<span class="glyphicon glyphicon-user" aria-hidden="true"></span>찜
										</button>
									</div>

								</div>

							</div>



						</div>


					</section>
					<div class="chart">
						<h3>영양정보</h3>
						<div style="width: 650px" class="col-xs-5">

							<canvas id="myChart"></canvas>
						</div>
						<div class="col-xs-4">
							<table class="table">

								<tr>
									<th>일일제공량</th>
									<td id="daily"></td>
								</tr>
								<tr>
									<th>칼로리</th>
									<td id="calo"></td>
								</tr>
								<tr>
									<th>탄수화물</th>
									<td id="carbo"></td>
								</tr>
								<tr>
									<th>단백질</th>
									<td id="prot"></td>
								</tr>
								<tr>
									<th>지방</th>
									<td id="fat"></td>
								</tr>
								<tr>
									<th>당류</th>
									<td id="sugar"></td>
								</tr>
								<tr>
									<th>나트륨</th>
									<td id="nat"></td>
								</tr>

								<tr>
									<th>콜레스테롤</th>
									<td id="col"></td>
								</tr>
								<tr>
									<th>포화지방산</th>
									<td id="sfat"></td>
								</tr>
								<tr>
									<th>트랜스지방</th>
									<td id="tfat"></td>
								</tr>
							</table>
						</div>
					</div>


				</div>
			</div>
		</div>
	</div>

	<!-- main end -->
	​




	<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
	<script src="bootstrap/js/bootstrap.bundle.min.js"></script>
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.min.js"></script>
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.css"></script>
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js"></script>

	<script>
		var findcode = null;
		
		var daily;
		var cal;
		var carbo;
		var pro;
		var fat;
		var sugar;
		var nat;
		var col;
		var sfat;
		var tfat;

		$(function() {
			findcode = getParameterByName('code');
			send();
			send2();
			console.log(findcode);
			console.log(cal);
			console.log(img);
		});

		// 우선 컨텍스트를 가져옵니다. 
		var ctx = document.getElementById("myChart").getContext('2d');
		/*
		- Chart를 생성하면서, 
		- ctx를 첫번째 argument로 넘겨주고, 
		- 두번째 argument로 그림을 그릴때 필요한 요소들을 모두 넘겨줍니다. 
		 */

		function dynamicColors() {
			var r = Math.floor(Math.random() * 255);
			var g = Math.floor(Math.random() * 255);
			var b = Math.floor(Math.random() * 255);
			return "rgba(" + r + "," + g + "," + b + ",0.8)";
		}

		function getParameterByName(name) {
			name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
			var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"), results = regex
					.exec(location.search);
			return results === null ? "" : decodeURIComponent(results[1]
					.replace(/\+/g, " "));
		}

		function send() {
			$.ajax({
				type : "get",
				url : "res/foodInfo.xml",
				dataType : "xml",
				success : resXml,
				error : eXml
			});
		}
		function eXml(s) {
			console.log(s);
		}
		var name;
		var img;
		function resXml(data) {
			//$(data).find('friend')
			name = $("food", data).eq(findcode).find("name").text();
			var maker = $("food", data).eq(findcode).find("maker").text();
			var material = $("food", data).eq(findcode).find("material").text();
			img = $("food", data).eq(findcode).find("image").text();
			
			
			$("#imagee").append("<img src=" + img + ">");


			$("#nameinfo").append(name);
			$("#proinfo").append(maker);
			$("#inginfo").append(material);

		};

		function send2() {
			$.ajax({
				type : "get",
				url : "res/FoodNutritionInfo.xml",
				dataType : "xml",
				success : resXml2,
				error : eXml2
			});
		}
		function eXml2(s) {
			console.log(s);
		}

		function resXml2(data) {
			//$(data).find('friend')
			daily = $("item", data).eq(findcode).find("SERVING_WT").text();
			cal = $("item", data).eq(findcode).find("NUTR_CONT1").text();
			carbo = $("item", data).eq(findcode).find("NUTR_CONT2").text();
			pro = $("item", data).eq(findcode).find("NUTR_CONT3").text();
			fat = $("item", data).eq(findcode).find("NUTR_CONT4").text();
			sugar = $("item", data).eq(findcode).find("NUTR_CONT5").text();
			nat = $("item", data).eq(findcode).find("NUTR_CONT6").text();
			col = $("item", data).eq(findcode).find("NUTR_CONT7").text();
			sfat = $("item", data).eq(findcode).find("NUTR_CONT8").text();
			tfat = $("item", data).eq(findcode).find("NUTR_CONT9").text();
			
			var myChart = new Chart(ctx, {
				type : 'doughnut',
				data : {
					labels : [ "칼로리", "탄수화물", "단백질", "지방", "당류", "나트륨",
							"콜레스테롤", "포화 지방산", "트랜스지방" ],
					datasets : [ {
						label : '# of Votes',
						data : [ cal, carbo, pro, fat, sugar, nat, col, sfat,
								tfat ],
						backgroundColor : [ dynamicColors(), dynamicColors(),
								dynamicColors(), dynamicColors(),
								dynamicColors(), dynamicColors(),
								dynamicColors(), dynamicColors(),
								dynamicColors()

						],

					} ]
				},
				options : {
					maintainAspectRatio : true, // default value. false일 경우 포함된 div의 크기에 맞춰서 그려짐.
					scales : {
						yAxes : [ {
							ticks : {
								beginAtZero : true
							}
						} ]
					}
				}
			});
			
			
			$("#daily").append(daily);
			$("#calo").append(cal);
			$("#carbo").append(carbo);
			$("#prot").append(pro);
			$("#fat").append(fat);
			$("#sugar").append(sugar);
			$("#nat").append(nat);
			$("#col").append(col);
			$("#sfat").append(sfat);
			$("#tfat").append(tfat);
			
		
			

		};
	</script>

</body>
</html>